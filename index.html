<!DOCTYPE html>
<html lang="en">
<head>
    <title>Aplikacja C# od Zera z CleanArchitecture, CQRS i Event Sourcing</title>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width" />
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:400,900&amp;subset=latin-ext" rel="stylesheet" />
    <!-- Shower Theme -->
    <link rel="stylesheet" href="vendors/shower-ribbon/styles/screen-16x9.css" />
    <link rel="stylesheet" href="vendors/shower-CezaryWalenciuk/styles/main.css" />
    <!-- Prism.js -->
    <link rel="stylesheet" href="vendors/prism/prism-my.css" />
    <link rel="stylesheet" href="vendors/prism/custom-prism.css" />
    <link rel="stylesheet" href="codegrid.css" />
</head>

<body class="shower list">
    <header class="caption">
        <h1>Aplikacja C# od Zera z CleanArchitecture, CQRS i Event Sourcing</h1>
        <p></p>
    </header>

    <section class="slide front-page">

        <div class="details">
            <!-- 1. Avatar -->


            <h2>Cezary Walenciuk</h2>

            <!-- 3. Presentation title -->
            <h2 class="bigbig"><strong style="font-size: 35px;  line-height: 1.3;">

                    <span class="titlec1">Aplikacja C# od Zera</span>
                    <br />
                    <span class="titlec5">z CleanArchitecture, CQRS i Event Sourcing</span>
                    <span class="titlec3"></span></strong></h2>



            <!-- 5. Contact the speaker -->
            <h2><a href="https://twitter.com/WalenciukC">@walenciukC</a></h2>
        </div>
        <div>


            <!-- 2. Speaker -->

        </div>
        <div class="imag">
            <img src="images/my-avatar.jpg" alt="Speaker">
        </div>
    </section>

    <!-- <section class="slide creamPPPGragient">
        <span class="shout colors" >Czy życie jest jak gra komputerowa ? <br />
           <span>
          🤔
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/01-jakgra.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide creamPPPGragient">
        <span class="shout colors" >Jak zostać lepszym programistą<br />
           <span>
         🤔
        </span></span>
    </section>
    <section class="slide creamPPPGragient">
        <span class="shout colors" >Gdybył miał stracić pracę jutro to czym znalazł szybko inną<br />
           <span>
         🤔
        </span></span>
    </section>
    <section class="slide creamPPPGragient">
        <span class="shout colors" >Czy jestem osobą, która zasiedziała się zadługo w jednej firmie<br />
           <span>
          🤔
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/02-cowybrac.jpg" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide creamPPPGragient">
        <span class="shout colors" >Nauczmy się wzorców i architektury 3-4-5 warstwowej<br />
           <span>
           🤔
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/book.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>W roku 2021 ta książka ma już przestarzałe rady
        </span></span>
    </section> -->
    <!-- <section class="slide creamPP">
        <span class="shout colors" ><span>Często zadaje sobie pytanie czy moja wiedza jest na czasie
        </span></span>
    </section>
    <section class="slide creamPP  fullscreen">
        <div class="grid-container-IconsText">
            <div class="Image1"><img  src="pictures/iconsFr/01.png" /></div>
            <div class="TitleMain"><h3>Czy twoja wiedza jest na czasie.</h3></div>
            <div class="Title1"><h3>Najlepsze prakyki?</h3></div>
          </div>
    </section>
    <section class="slide creamPP  fullscreen">
        <div class="grid-container-IconsText">
            <div class="Image1"><img  src="pictures/iconsFr/01.png" /></div>
            <div class="Image2"> <img src="pictures/iconsFr/02.png" /></div>
            <div class="TitleMain"><h3>Czy twoja wiedza jest na czasie.</h3></div>
            <div class="Title1"><h3>Najlepsze prakyki?</h3></div>
            <div class="Title2"><h3>Paczki NuGet?</h3></div>
          </div>
    </section>
    <section class="slide creamPP  fullscreen">
        <div class="grid-container-IconsText">
            <div class="Image1"><img  src="pictures/iconsFr/01.png" /></div>
            <div class="Image2"> <img src="pictures/iconsFr/02.png" /></div>
            <div class="Image3"><img src="pictures/iconsFr/03.png" /></div>
            <div class="TitleMain"><h3>Czy twoja wiedza jest na czasie.</h3></div>
            <div class="Title1"><h3>Najlepsze prakyki?</h3></div>
            <div class="Title2"><h3>Paczki NuGet?</h3></div>
            <div class="Title3"><h3>Jasna architektura</h3></div>
          </div>
    </section>
    <section class="slide creamPP fullscreen">
        <div class="grid-container-IconsText">
            <div class="Image1"><img  src="pictures/iconsFr/01.png" /></div>
            <div class="Image2"> <img src="pictures/iconsFr/02.png" /></div>
            <div class="Image3"><img src="pictures/iconsFr/03.png" /></div>
            <div class="Image4"><img src="pictures/iconsFr/04.png" /></div>
            <div class="TitleMain"><h3>Czy twoja wiedza jest na czasie.</h3></div>
            <div class="Title1"><h3>Najlepsze prakyki?</h3></div>
            <div class="Title2"><h3>Paczki NuGet?</h3></div>
            <div class="Title3"><h3>Jasna architektura</h3></div>
            <div class="Title4"><h3>Testowalna, Łatwa do zarządzania</h3></div>
          </div>
    </section> -->
    <section class="slide creamPP">
        <span class="shout colors" ><span>Jak to napisać ? 🤔
        </span></span>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span> <span class="giveorange">Od zera...</span> 😱
        </span></span>
    </section>
    <section class="slide creamGGGragient">
        <span class="shout colors smallerfont2" ><span>Na każdej konferencji była chociaż 1 prelekcja na temat  <span class="giveorange">CQRS</span>, 
            ale nic z tego nie zapamiętałem bo nigdy nie pisałem takiej aplikacji
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/05_ApliacjaCsharpOdZeraArchitekturaCqrs_Timmer.png" alt="webinary">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/06_AplikacjaodzerazDDDEventSourcing_Timmer.png" alt="webinary">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Teraz mamy z <span class="giveorange">43</span> minuty
        </span></span>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Co chcemy <br /> <span>zbudować
            👨‍💻
        </span></span>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/Adobe/CQRS-03.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/Adobe/CQRS-04.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP  fullscreen">
        <div class="grid-containerOnlyTwo ">
            <div class="ImageOnlyTwo1 "><img  src="pictures/iconsFr2/withouteventsourcing.png" /></div>
            <div class="TitleOnlyTwo"><h3>Chemy mieć aplikacje z dwoma ścieżkami</h3></div>
            <div class="TextOnlyTwo1 "><h3>Bez EventSourcing</h3></div>
          </div>
    </section>
    <section class="slide creamPP  fullscreen">
        <div class="grid-containerOnlyTwo ">
            <div class="ImageOnlyTwo1 "><img  src="pictures/iconsFr2/withouteventsourcing.png" /></div>
            <div class="ImageOnlyTwo2 "><img src="pictures/iconsFr2/witheventsourcing.png" /></div>
            <div class="TitleOnlyTwo"><h3>Chemy mieć aplikacje z dwoma ścieżkami</h3></div>
            <div class="TextOnlyTwo1 "><h3>Bez EventSourcing</h3></div>
            <div class="TextOnlyTwo2 "><h3>Z EventSourcing</h3></div>
          </div>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/Adobe/CQRS-06.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/Adobe/CQRS-07.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/Adobe/CQRS-03.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP   compact ">
        <h2>Co mamy omówić ?</h2>
        <ol class="nonumbers">
            <li class="next">Jakie paczki NuGet ?</li>
            <li class="next">Co to jest <span class="green">Clean Architecture ?</span></li>
        </ol>
    </section>
    <section class="slide creamGG fullscreen smaller">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr/nuget.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers ">
                    <li class="next bold">Jakie paczki NuGet? (Spoiler)&nbsp;&nbsp; &nbsp;&nbsp;</li>
                    <ol class="nonumbers">
                        <li class="next">MediatR</li>
                        <li class="next">AutoMapper</li>
                        <li class="next">Fluent Validation</li>
                        <li class="next">Swagger UI</li>
                        <li class="next">Dapper (zamiast EF Core)</li>
                        <li class="next">Newtonsoft.Json do serializacji&nbsp;&nbsp; &nbsp;&nbsp;</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>
    <section class="slide creamGG">
        <span class="shout colors" ><span>Przypomny sobie szybko 
            <br /> <span class="green">Clean Architecture</span></span></span>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/old/layers/ilewartstw2.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/old/circular/inverted-layered-complex-dependency-graph.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/old/circular/onion-layers-dependency-graph.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/old/circular/hexagonal-architecture-dependency-graph.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPPP   compact ">
        <h2>Mamy dwa style <span class="green">Clean Architecture</span></h2>
        <ol class="nonumbers">
            <li class="next">Onion 🧅</li>
            <li class="next">Hexagonalna (Porty i Adaptery)</li>
            <li class="next">Jeden architekt powie, że to jest to samo - drugi, że nie</li>
        </ol>
    </section>

    <section class="slide creamGG">
        <span class="shout colors" ><span>Jak skoncentruje się na Cebuli ? <br />🧅
        </span></span>
    </section>
    <section class="slide creamPP" >
        <figure>
            <img class="cover" src="pictures/old/circular/circular desing-0-t.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP" >
        <figure>
            <img class="cover" src="pictures/old/circular/circular desing-t.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP" >
        <figure>
            <img class="cover" src="pictures/old/circular/circular desing-1-t.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP fullscreen smaller">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr/connected.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Jak osiągnać luźne powiązania ?</li>
                    <ol class="nonumbers">
                        <li class="next">Kontrakty czyli Interfejsy</li>
                        <li class="next">Wysłanie sobie komend : Mediator z CQRS &nbsp;&nbsp;</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>  
    <!-- <section class="slide creamPP fullscreen smaller">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr/contract.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Kontrakty czyli Interfejsy</li>
                    <ol class="nonumbers">
                        <li class="next">Opisujemy co chcemy</li>
                        <li class="next">Implementujemy w Core albo w Infrastrukturze</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>   -->

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/last.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide creamPP fullscreen " >
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/old/circular/circular desing-01-t.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Application Core</li>
                    <ol class="nonumbers">
                        <li class="next">Interfejsy i encje</li>
                        <li class="next">Logika biznesowa i przypadki użycia, która jest centrum aplikacji</li>
                        <li class="next">Niezależna od zewnętrznych kółek</li>
                        <li class="next">Nie ma zależności</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>  
    <section class="slide creamPP   compact ">
        <h2>Co budjemy przy pomocy <span class="giveorange">CQRS</span> i <span class="giveorange">EventSourcing</span> ?</h2>
        <ol class="nonumbers">
            <li class="next">API do dodawania programistów</li>
            <li class="next">Później możemy odrzucić lub zaacektpować danego programistę</li>
            <li class="next">Programista raz odrzucony lub zaakceptowany nie może zmienic swojego statusu</li>
        </ol>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>Domain
            👨‍💻
        </span></span>
    </section>
    <!-- <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures/gdziejestemy/DomainLogic.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section> -->
    <!-- <section class="slide creamPP fullscreen">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/circular/circular desing-04-t.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Interface and Entities</li>
                    <ol class="nonumbers">
                        <li class="next">Centrum całej aplikacji</li>
                        <li class="next">Ich nazewnictwo to ból głowy</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>  
    <section class="slide creamPP fullscreen smaller">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/circular/circular desing-03-t.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Co idzie do Core</li>
                    <ol class="nonumbers">
                        <li class="next">Encję, Interfejsy</li>
                        <li class="next">Services (usługi)</li>
                        <li class="next">Exceptions</li>
                        <li class="next">Nie ma zależności do kodu z Infrastury czy jego paczek</li>
                        <li class="next">Domain Events</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>   -->

    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/03.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/04.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/05.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/06.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/07.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/gdzie/domain.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/08.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Developer</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 32px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 32px !important;">
                        public class Developer : 
                            Entity&lt;DeveloperId, DeveloperUniqueId&gt;

                        {
                            public string Name { get; set; }
                            public DeveloperStatus Status { get; set; }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperStatus</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 35px !important;">
                        public enum DeveloperStatus
                        {
                           New = 0,
                           Accepted = 1,
                           Rejected = 2,
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Entity</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 35px !important;">
                        public abstract class Entity&lt;T1, T2&gt;
                        {
                           public T1 Id { get; set; }
                           public T2 UniqueId { get; set; }
                        
                           public int Version { get; set; }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperId</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 35px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 35px !important;">

                        public class DeveloperId
                        {
                            public int Value { get; set; }
                    
                            public DeveloperId(int value)
                            {
                                Value = value;
                            }
                    
                            public DeveloperId()
                            {
                                Value = default;
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperUniqueId i BaseUniqueId, AggregateKey</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">



















                        



                        public class DeveloperUniqueId : BaseUniqueId&lt;Guid&gt;
                        {
                            public Guid Value { get; set; }
                        
                            public override string ValueInString()
                            {
                                return Value.ToString();
                            }
                        
                            public DeveloperUniqueId()
                            {
                                Value = Guid.NewGuid();
                            }
                        
                            public DeveloperUniqueId(Guid value)
                            {
                                Value = value;
                            }
                        }

                        public abstract class BaseUniqueId&lt;T&gt;
                        {
                            public abstract string ValueInString();
                        
                            public AggregateKey GetAggregateKey()
                            {
                                return new AggregateKey
                                {
                                    Id = ValueInString(),
                                };
                            }
                        
                            public BaseUniqueId()
                            {
                        
                            }
                        }

                        public class AggregateKey
                        {
                            public string Id { get; set; }
                    
                            public static readonly AggregateKey Empty = new AggregateKey();
                    
                            public override string ToString()
                            {
                                return Id;
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamGG fullscreen smaller">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr/nuget.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers ">
                    <li class="next bold">Po co nam unikatowe ID w EventSourcing&nbsp;&nbsp; &nbsp;&nbsp;</li>
                    <ol class="nonumbers">
                        <li class="next">Unikatowe ID można utworzyć przed wysłaniem zdarzenia i przed zapisem do bazy</li>
                        <li class="next">Te unikatowe ID będzie na potrzebne do aggregacji zdarzeń na danej encji</li>
                        <ol  class="nonumbers next">
                            <li>Z UID stworzymy klucz <span class="green">AggregateKey</span></li>
                        </ol>
                        <li class="next">Ten <span class="green">AggregateKey</span> pomoże nam szukać w bazie zdarzeń poprzednich wersji</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperIds</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public class DeveloperIds
                        {
                            public DeveloperId CreatedId { get; set; }
                            public DeveloperUniqueId UniqueId { get; set; }
                    
                            [JsonIgnore]
                            public IdsStatus ExStatus { get; set; }
                    
                            public string Status
                            {
                                get
                                {
                                    return ExStatus.ToString();
                                }
                            }
                        }
                    
                        public enum IdsStatus
                        {
                            CreateIdReturned = 0,
                            DudeYouCantReturnCreatedIdWhenYouAreEventSourcing = 1
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Developer</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public class Developer : 
                            Entity&lt;DeveloperId, DeveloperUniqueId&gt;

                        {
                            public string Name { get; set; }
                            public DeveloperStatus Status { get; set; }

                            public DeveloperIds Ids()
                            {
                                if (this.Id != null && this.Id.Value != default)
                                    return new DeveloperIds()
                                    {
                                        UniqueId = this.UniqueId,
                                        CreatedId = this.Id
                                    };
                                else
                                    return new DeveloperIds()
                                    {
                                        UniqueId = this.UniqueId,
                                        CreatedId = this.Id,
                                        ExStatus = IdsStatus.DudeYouCantReturnCreatedIdWhenYouAreEventSourcing
                                    };
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/start/09.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>Application
            👨‍💻
        </span></span>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">IDeveloperRepository, IZEsDeveloperRepository, FilterDeveloperStatus</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">










                        public interface IDeveloperRepository
                        {
                            Task&lt;IReadOnlyList&lt;Developer&gt;&gt; GetCollectionAsync(
                                FilterDeveloperStatus filtrer);
                                            
                            Task&lt;Developer&gt; GetByIdAsync(DeveloperId id);
                                            
                            Task&lt;Developer&gt; GetByIdAsync(DeveloperUniqueId id);
                                            
                            Task&lt;DeveloperIds&gt; SubmitAsync(Developer developer);
                                            
                            Task&lt;bool&gt; SaveAcceptenceAsync(DeveloperUniqueId id);
                                            
                            Task&lt;bool&gt; SaveAcceptenceAsync(DeveloperId id);
                                            
                            Task&lt;bool&gt; SaveRejectionAsync(DeveloperUniqueId id);
                                            
                            Task&lt;bool&gt; SaveRejectionAsync(DeveloperId id);
                        }
                        
                        public interface IZEsDeveloperRepository : IDeveloperRepository
                        {
                        
                        }

                        public enum FilterDeveloperStatus
                        {
                            All = 100,
                            New = 0,
                            Accepted = 1,
                            Rejected = 2,
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/07.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/08.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">BaseResponse</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">

























































                        public abstract class BaseResponse
                        {
                            public ResponseStatus Status { get; set; }
                                            
                            public bool Success { get; set; }
                            public string Message { get; set; }
                                            
                            public List&lt;string&gt; ValidationErrors { get; set; }
                                            
                                            
                            protected BaseResponse()
                            {
                                ValidationErrors = new List&lt;string&gt;();
                                Success = true;
                                Status = ResponseStatus.Success;
                            }
                                            
                            protected BaseResponse(string message = null)
                            {
                                ValidationErrors = new List&lt;string&gt;();
                                Success = true;
                                Message = message;
                                Status = ResponseStatus.Success;
                            }
                                            
                            protected BaseResponse(string message, bool success)
                            {
                                ValidationErrors = new List&lt;string&gt;();
                                Success = success;
                                Message = message;
                            }
                                            
                            protected BaseResponse(ResponseStatus status)
                            {
                                ValidationErrors = new List&lt;string&gt;();
                                Success = status != ResponseStatus.Success;
                                Status = status;
                            }
                                            
                            protected BaseResponse(ValidationResult validationResult)
                            {
                                ValidationErrors = new List&lt;String&gt;();
                                Success = validationResult.Errors.Count &lt; 0;
                                foreach (var item in validationResult.Errors)
                                {
                                    ValidationErrors.Add(item.ErrorMessage);
                                }
                                            
                                if (!Success)
                                    Status = ResponseStatus.ValidationError;
                                else
                                    Status = ResponseStatus.Success;
                            }
                                            
                            public string StatusInfo
                            {
                                get
                                {
                                    return Status.ToString();
                                }
                            }
                                            
                            public WhatHTTPCodeShouldBeRetruned WhatHTTPCodeToBeRetruned
                            {
                                get
                                {
                                    if (this.Status == ResponseStatus.BussinesLogicError)
                                        return WhatHTTPCodeShouldBeRetruned.Forbid;
                                    if (this.Status == ResponseStatus.NotFoundInDataBase)
                                        return WhatHTTPCodeShouldBeRetruned.NotFound;
                                    if (this.Status == ResponseStatus.ValidationError ||
                                        this.Status == ResponseStatus.BadQuery ||
                                        this.Status == ResponseStatus.ConcurrencyOlderVersionSendedWhenNewerIsInEventStore)
                                        return WhatHTTPCodeShouldBeRetruned.BadRequest;
                                    if (!this.Success)
                                        return WhatHTTPCodeShouldBeRetruned.BadRequest;
                                    else
                                        return WhatHTTPCodeShouldBeRetruned.Ok;
                                }
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/03.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/gdzie/cqrsbezeve.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/04.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/05.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/06.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/09.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/application/10.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Zobaczmy jak wygląda <span class="giveorange">GetAllDevelopers</span> 
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperInListViewModel</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 34px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 34px !important;">
                        public class DeveloperInListViewModel
                        {
                            public string Name { get; set; }
                            public int Status { get; set; }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperInListViewModel</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 25px !important;">
                        public class GetAllDevelopersQuery 
                            : IRequest&lt;GetAllDevelopersQueryHandlerResponse&gt;
                        {
                            public FilterDeveloperStatus Filter { get; set; }
                        
                            public QueryWitchDataBase queryWitchDataBase { get; set; }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">GetAllDevelopersQueryHandlerResponse</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">





                        public class GetAllDevelopersQueryHandlerResponse : BaseResponse
                        {
                            public List&lt;DeveloperInListViewModel&gt; List { get; }
                                            
                            public GetAllDevelopersQueryHandlerResponse
                                (List&lt;DeveloperInListViewModel&gt; lisy) : base()
                            {
                                List = lisy;
                            }
                                            
                                            
                            public GetAllDevelopersQueryHandlerResponse(ValidationResult validationResult)
                            : base(validationResult)
                            { }
                                            
                            public GetAllDevelopersQueryHandlerResponse(string message)
                            : base(message)
                            { }
                                            
                            public GetAllDevelopersQueryHandlerResponse(string message, bool success)
                                : base(message, success)
                            { }
                                            
                            public GetAllDevelopersQueryHandlerResponse(ResponseStatus status) : base(status)
                            { }
                                            
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">GetAllDevelopersQueryHandler</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">















                        public class GetAllDevelopersQueryHandler
                        :
                        IRequestHandler&lt;GetAllDevelopersQuery,
                            GetAllDevelopersQueryHandlerResponse&gt;

                        {
                            private readonly IDeveloperRepository _Repository;
                            private readonly IMapper _mapper;
                            private readonly IZEsDeveloperRepository _zEsRepository;
                                        
                            public GetAllDevelopersQueryHandler(IDeveloperRepository callRepository,
                                IZEsDeveloperRepository ZEscallRepository,
                                        
                                IMapper mapper)
                            {
                                _mapper = mapper;
                                _zEsRepository = ZEscallRepository;
                                _Repository = callRepository;
                            }
                                        
                            public async Task&lt;GetAllDevelopersQueryHandlerResponse&gt; 
                            Handle(GetAllDevelopersQuery request, CancellationToken cancellationToken)
                            {
                                IReadOnlyList&lt;Developer&gt; listresult;
                                        
                                if (request.queryWitchDataBase == QueryWitchDataBase.WithEventSourcing)
                                    listresult = await _zEsRepository.GetCollectionAsync(request.Filter);
                                else
                                    listresult = await _Repository.GetCollectionAsync(request.Filter);
                                        
                                if (listresult == null)
                                    return new GetAllDevelopersQueryHandlerResponse
                                        (ResponseStatus.NotFoundInDataBase);
                                        
                                        
                                var allordered = listresult.OrderBy(x =&gt; x.Id);
                                var allmaped = _mapper.Map&lt;List&lt;DeveloperInListViewModel&gt;&gt;(listresult);
                                return new GetAllDevelopersQueryHandlerResponse(allmaped);
                                        
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamPP" >
        <figure>
            <img class="cover" src="pictures2/application/11.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Zobaczmy jak wygląda <span class="giveorange">SubmitDeveloperCommand</span>
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubmitDeveloperCommand</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 25px !important;">
                        public class SubmitDeveloperCommand 
                        : IRequest&lt;SubmitDeveloperCommandResponse&gt;
                        {
                            public string Name { get; set; }
                        
                            [JsonIgnore]
                            public DeveloperUniqueId UniqueId { get; }
                            [JsonIgnore]
                            public DeveloperStatus Status { get; }
                        
                            public SubmitDeveloperCommand()
                            {
                                UniqueId = new DeveloperUniqueId();
                                Status = DeveloperStatus.New;
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubmitDeveloperCommandResponse</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">



                        public class SubmitDeveloperCommandResponse : BaseResponse
                        {
                            public DeveloperIds DeveloperIds { get; set; }
                    
                            public SubmitDeveloperCommandResponse(DeveloperIds ids)
                            : base()
                            {
                                DeveloperIds = ids;
                            }
                    
                            public SubmitDeveloperCommandResponse(ValidationResult validationResult)
                            : base(validationResult)
                            { }
                    
                            public SubmitDeveloperCommandResponse(string message)
                            : base(message)
                            { }
                    
                            public SubmitDeveloperCommandResponse(string message, bool success)
                                : base(message, success)
                            { }
                    
                            public SubmitDeveloperCommandResponse(ResponseStatus status) : base(status)
                            { }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubmitDeveloperCommandResponse</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 25px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 25px !important;">
                        public class SubmitDeveloperCommandValidator
                        : AbstractValidator&lt;SubmitDeveloperCommand&gt;
                        {
                            public SubmitDeveloperCommandValidator()
                            {
                                RuleFor(c =&gt; c.Name)
                                    .MinimumLength(1)
                                    .MaximumLength(100)
                                    .WithMessage(&quot;{PropertName} Length is beewten 1 and 100&quot;);
                                        
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubmitDeveloperCommandResponse</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">












                        public class SubmitDeveloperCommandHandler
                        :
                        IRequestHandler&lt;SubmitDeveloperCommand,
                            SubmitDeveloperCommandResponse&gt;
                        {
                            private readonly IDeveloperRepository _repository;
                            private readonly IMapper _mapper;
                                        
                            public SubmitDeveloperCommandHandler(IDeveloperRepository Repository,
                            IMapper mapper)
                            {
                                _mapper = mapper;
                                _repository = Repository;
                            }



                                        
                            public async Task&lt;SubmitDeveloperCommandResponse&gt;
                             Handle(SubmitDeveloperCommand request, CancellationToken cancellationToken)
                            {
                                var validator = new SubmitDeveloperCommandValidator();
                                var validatorResult = await validator.ValidateAsync(request);
                                        
                                if (!validatorResult.IsValid)
                                    return new SubmitDeveloperCommandResponse(validatorResult);
                                        
                                var developer = _mapper.Map&lt;Developer&gt;(request);
                                developer.Status = DeveloperStatus.New;
                                        
                                var ids = await _repository.SubmitAsync(developer);
                                        
                                return new SubmitDeveloperCommandResponse(ids);
                            }

                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Zobaczmy jak wygląda <span class="giveorange">RejectDeveloper</span> i <span class="giveorange">AcceptDeveloper</span>
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">RejectDeveloperCommandHandler</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">













                        public class RejectDeveloperCommandHandler
                        :
                        IRequestHandler&lt;RejectDeveloperCommand, RejectDeveloperCommandResponse&gt;
                        {
                            private readonly IDeveloperRepository _callRepository;
                            private readonly IMapper _mapper;
                    
                            public RejectDeveloperCommandHandler(IDeveloperRepository callRepository,
                                IMapper mapper)
                            {
                                _callRepository = callRepository;
                                _mapper = mapper;
                            }
                    




                            public async Task&lt;RejectDeveloperCommandResponse&gt; Handle
                                (RejectDeveloperCommand request, CancellationToken cancellationToken)
                            {
                                var developerUniqueId = _mapper.Map&lt;DeveloperUniqueId&gt;
                                    (request.DeveloperUniqueId);
                    
                                var developer = await _callRepository.GetByIdAsync(developerUniqueId);
                    
                                if (developer.Status == DeveloperStatus.New)
                                    await _callRepository.SaveRejectionAsync
                                        (developerUniqueId);
                                else
                                {
                                    return new RejectDeveloperCommandResponse(&quot;Can&#39;t Reject Developer &quot; +
                                        &quot;that is already &quot; + developer.Status.ToString(), false);
                                }
                    
                                return new RejectDeveloperCommandResponse();
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">AcceptDeveloperCommandHandler</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">













                        public class AcceptDeveloperCommandHandler
                        :
                        IRequestHandler&lt;AcceptDeveloperCommand, AcceptDeveloperCommandResponse&gt;
                        {
                            private readonly IDeveloperRepository _callRepository;
                            private readonly IMapper _mapper;
                    
                            public AcceptDeveloperCommandHandler(IDeveloperRepository callRepository,
                                IMapper mapper)
                            {
                                _callRepository = callRepository;
                                _mapper = mapper;
                            }
                    




                            public async Task&lt;AcceptDeveloperCommandResponse&gt; Handle
                                (AcceptDeveloperCommand request, CancellationToken cancellationToken)
                            {
                                var developerUniqueId = _mapper.Map&lt;DeveloperUniqueId&gt;
                                    (request.DeveloperUniqueId);
                    
                    
                                var developer = await _callRepository.GetByIdAsync(developerUniqueId);
                    
                                if (developer.Status == DeveloperStatus.New)
                                    await _callRepository.SaveAcceptenceAsync
                                        (developerUniqueId);
                                else
                                {
                                    return new AcceptDeveloperCommandResponse(&quot;Can&#39;t Accept Developer &quot; +
                                        &quot;that is already &quot; + developer.Status.ToString(), false);
                                }
                    
                                return new AcceptDeveloperCommandResponse();
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Potrzebujemy jeszcze mapowania z  <span class="giveorange">Automappera</span>
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">AutoMappera</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public class ProfileMap : Profile
                        {
                            public ProfileMap()
                            {
                                CreateMap&lt;int, DeveloperId&gt;().ConstructUsing
                                    (c =&gt; new DeveloperId(c));
                                            
                                CreateMap&lt;DeveloperId, int&gt;().ConstructUsing(c =&gt; c.Value);
                                            
                                CreateMap&lt;Guid, DeveloperUniqueId&gt;().ConstructUsing
                                    (c =&gt; new DeveloperUniqueId(c));
                                            
                                CreateMap&lt;DeveloperUniqueId, Guid&gt;().ConstructUsing
                                    (c =&gt; c.Value);
                                            
                                CreateMap&lt;Developer, DeveloperViewModel&gt;();
                                CreateMap&lt;Developer, DeveloperInListViewModel&gt;();
                                            
                                CreateMap&lt;SubmitDeveloperCommand, Developer&gt;();
                                CreateMap&lt;EsSubmitDeveloperCommand, Developer&gt;();
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Potrzebujemy jeszcze <span class="giveorange">instalatora IServiceCollection</span>
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">LiteSmallConferenceInstaller</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public static partial class LiteSmallConferenceInstaller
                        {
                    
                            public static IServiceCollection AddLiteSmallConferenceCQRS
                        (this IServiceCollection services, IConfiguration Configuration)
                            {
                                services.AddAutoMapper(Assembly.GetExecutingAssembly());
                                services.AddMediatR(Assembly.GetExecutingAssembly());
                    
                                return services;
                            }
                    
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Zobaczmy projekt<br /> <span>Infrastructure
            👨‍💻
        </span></span>
    </section>
    <section class="slide creamPP fullscreen smaller">
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/circular/circular desing-03-t.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Co idzie do Infrastructure?</li>
                    <ol class="nonumbers">
                        <li class="next">Dostęp do danych (EF Core, Dapper)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
                        <li class="next">Loggowanie</li>
                        <li class="next">Autoryzacja</li>
                        <li class="next">API Klienckie</li>
                        <li class="next">Dostęp do plików</li>
                    </ol>
                </ol>
            </div>
          </div>
    </section> 
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/gdzie/infrastructure.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/infra/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/infra/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/infra/03.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">LiteSmallConferenceInstaller</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">























                        public static partial class LiteSmallConferenceInstaller
                        {
                                            
                            public static IServiceCollection AddPersitenceDapperSQLite
                            (this IServiceCollection services, IConfiguration configuration)
                            {
                                services.AddAutoMapper(Assembly.GetExecutingAssembly());
                                            
                                var connection = configuration.
                                    GetConnectionString(&quot;LiteSmallConferenceConnectionString&quot;);
                                var zEsConnection = configuration.
                                    GetConnectionString(&quot;ZEsLiteSmallConferenceConnectionString&quot;);
                                            
                                services.AddTransient&lt;ILiteSmallDBContext, LiteSmallDBContext&gt;
                                    (
                                        (services) =&gt;
                                        {
                                            var c =
                                            new LiteSmallDBContext(connection);
                                            return c;
                                        }
                                    );
                                            
                                services.AddTransient&lt;IZEsLiteSmallDBContext, LiteSmallDBContext&gt;
                                (
                                    (services) =&gt;
                                    {
                                        var c =
                                        new LiteSmallDBContext(zEsConnection);
                                        return c;
                                    }
                                );
                                            
                                services.AddTransient&lt;IDeveloperGetAllDoer, DeveloperGetAllDoer&gt;();
                                services.AddTransient&lt;IDeveloperGetByIdDoer, DeveloperGetByIdDoer&gt;();
                                services.AddTransient&lt;IDeveloperSaveAcceptanceDoer, DeveloperSaveAcceptanceDoer&gt;();
                                services.AddTransient&lt;IDeveloperSaveRejectionDoer, DeveloperSaveRejectionDoer&gt;();
                                services.AddTransient&lt;IDeveloperSubmitDoer, DeveloperSubmitDoer&gt;();
                                            
                                services.AddTransient&lt;IDeveloperRepository, DeveloperRepository&gt;();
                                services.AddTransient&lt;IZEsDeveloperRepository, ZEsDeveloperRepository&gt;();
                                            
                                return services;
                            }
                                            
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>API
            👨‍💻
        </span></span>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/gdzie/restapi.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/api/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/api/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/api/03.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/api/04.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Jak testować <span class="giveorange">REST API</span> ?
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/fidlder.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/api/05.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Startup</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">






































                        public class Startup
                        {
                                            
                            public IConfiguration Configuration { get; }
                                            
                            public Startup(IConfiguration configuration)
                            {
                                Configuration = configuration;
                            }
                                                         
                                            
                            public void ConfigureServices(IServiceCollection services)
                            {       
                                services.AddLiteSmallConferenceCQRS(Configuration);
                                services.AddPersitenceDapperSQLite(Configuration);
                                            
                                services.AddControllers();
                                services.AddCors(options =&gt;
                                {
                                    options.AddPolicy(&quot;Open&quot;,
                                        builder =&gt; builder.AllowAnyOrigin().AllowAnyHeader().AllowAnyMethod());
                                });
                        
                                services.AddSwaggerGen(c =&gt;
                                {
                                    c.AddSecurityDefinition(&quot;Bearer&quot;, new OpenApiSecurityScheme
                                    {
                                        Description = @&quot;JWT Authorization header using the Bearer scheme. \r\n\r\n 
                                          Enter &#39;Bearer&#39; [space] and then your token in the text input below.
                                          \r\n\r\nExample: &#39;Bearer 12345abcdef&#39;&quot;,
                                        Name = &quot;Authorization&quot;,
                                        In = ParameterLocation.Header,
                                        Type = SecuritySchemeType.ApiKey,
                                        Scheme = &quot;Bearer&quot;
                                    });
                                            
                                    c.AddSecurityRequirement(new OpenApiSecurityRequirement()
                                      {
                                        {
                                          new OpenApiSecurityScheme
                                          {
                                            Reference = new OpenApiReference
                                              {
                                                Type = ReferenceType.SecurityScheme,
                                                Id = &quot;Bearer&quot;
                                              },
                                              Scheme = &quot;oauth2&quot;,
                                              Name = &quot;Bearer&quot;,
                                              In = ParameterLocation.Header,
                                            
                                            },
                                            new List&lt;string&gt;()
                                          }
                                        });
                                            
                                    c.SwaggerDoc(&quot;v1&quot;, new OpenApiInfo
                                    {
                                        Version = &quot;v1&quot;,
                                        Title = &quot;LiteSmallConference API&quot;,
                                    });
                                            
                                });
                            }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DevelopersController</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">

















                        























                        


















                        























                        

















                        























                        


















                        
















                        public class DevelopersController : BaseLiteSmallConference
                        {
                            private readonly IMediator _mediator;
                                            
                            public DevelopersController(IMediator mediator)
                            {
                                _mediator = mediator;
                            }
                                            
                            [HttpPost(&quot;submit&quot;, Name = &quot;submitdeveloper&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;DeveloperIds&gt;&gt; Submit
                            ([FromBody] SubmitDeveloperCommand request)
                            {
                                var result = await _mediator.Send(request);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return Ok(result.DeveloperIds);
                            }
                                            
                            [HttpGet(&quot;all/{filter}&quot;, Name = &quot;getalldevelopers&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;DeveloperInListViewModel&gt;&gt; 
                            GetAllDevelopers(int filter)
                            {
                                GetAllDevelopersQuery getAllDevelopersQuery = new GetAllDevelopersQuery()
                                {
                                    Filter = (FilterDeveloperStatus)filter,
                                    queryWitchDataBase = QueryWitchDataBase.NormalCQRS
                                };
                                            
                                var result = await _mediator.Send(getAllDevelopersQuery);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return Ok(result.List);
                            }
                                            
                            [HttpGet(&quot;id/{id}&quot;, Name = &quot;GetDeveloperId&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesDefaultResponseType]
                            public async Task&lt;ActionResult&lt;DeveloperViewModel&gt;&gt; 
                            GetDeveloperId(int id)
                            {
                                var result = await _mediator.Send(
                                    (new GetDeveloperQuery()
                                    {
                                        DeveloperId = new DeveloperId(id),
                                        queryWitchDataBase = QueryWitchDataBase.NormalCQRS
                                    }));
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return Ok(result.Developer);
                            }
                                            
                            [HttpGet(&quot;uniqueid/{uid}&quot;, Name = &quot;GetDeveloperByUniqueId&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesDefaultResponseType]
                            public async Task&lt;ActionResult&lt;DeveloperViewModel&gt;&gt; 
                            GetDeveloperByUniqueId(Guid uid)
                            {
                                var result = await _mediator.Send(
                                    (new GetDeveloperQuery()
                                    {
                                        DeveloperUniqueId = new DeveloperUniqueId(uid),
                                        queryWitchDataBase = QueryWitchDataBase.NormalCQRS
                                    }));
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return Ok(result.Developer);
                            }
                                            
                            [HttpPost(&quot;reject&quot;, Name = &quot;rejectcallforspeech&quot;)]
                            [ProducesResponseType(StatusCodes.Status204NoContent)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;int&gt;&gt; Reject
                            ([FromBody] RejectDeveloperCommand rejectdeveloperCommand)
                            {
                                var result = await _mediator.Send(rejectdeveloperCommand);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return NoContent();
                                            
                            }
                                            
                                            
                            [HttpPost(&quot;accept&quot;, Name = &quot;acceptcallforspeech&quot;)]
                            [ProducesResponseType(StatusCodes.Status204NoContent)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;int&gt;&gt; Accept
                            ([FromBody] AcceptDeveloperCommand acceptDeveloperCommand)
                            {
                                var result = await _mediator.Send(acceptDeveloperCommand);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                            
                                return NoContent();
                                            
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
 

    <section class="slide" style="background-color: black;" >
        <figure>
            <img class="cover" src="pictures2/api/SWAGGERUI.gif" alt="blog">
            <figcaption class="white">Copyright © 2021 Onion Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPPPGragient">
        <span class="shout colors" >Oto aplikacja napisana w stylu <span class="giveorange">CQRS</span>  i <span class="green">CleanArchitecture</span>
        </span></span>
    </section>
    <section class="slide creamGGGragient ">
        <span class="shout colors smallerfont2" >Jak był sens podziału na Command i Query ?
           <br /> <span>🏗️</span><br /><br /> Mieliśmy Single Responsibility Principle
            <br /> Łatwy testowalny kod
        </span>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Pora na <span class="blue2">EventSourcing</span><br />
            <span>👨‍💻
        </span></span>
    </section>
    <section class="slide creamPP fullscreen " >
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr2/cons.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers " style="font-size: 80%;">
                    <li class=" bold">Problemy i wady <span class="blue2">Event Sourcing</span></li>
                    <ol class="nonumbers">
                        <li class="next">Zwiększona złożoność aplikacji</li>
                        <li class="next">Kasowanie danych bo RODO</li>
                        <li class="next">Potrzeba unikatowych identyfikatorów encji przed operacjami</li>
                        <li class="next">Problemy z tak zwaną <br /> <span class="red">"eventual consistency"</span></li>
                  
                    </ol>
                </ol>
            </div>
          </div>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >O to moja prawdziwa historia z zakupem abonamentu w Player TVN
        </span></span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Kupiłem abonament, ale nawet po 5 minutach nie mogłem oglądać swojego pakietu
        </span></span>
    </section>

    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/Screenshot_20210304-220055_player.jpg" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide creamPPPGragient">
        <span class="shout colors" >Godzinę później już tak
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/Screenshot_20210227-194753_player.jpg" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/Adobe/CQRS-03.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Cezary Walenciuk</figcaption>
        </figure>
    </section>
    <section class="slide creamPP fullscreen " >
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr2/speedometer.png" />
            </div>
            <div class="SlidePointText">
                <ol class="nonumbers">
                    <li class="next bold">Zaleta : Lepszy Performance</li>
                    <ol class="nonumbers">
                        <li class="next">Prawdopodobnie najlepszy powód &nbsp;&nbsp;&nbsp;&nbsp;</li>
                        <li class="next">A to wynika z innego powodu. A dokładnie...</li>

                    </ol>
                </ol>
            </div>
          </div>
    </section>
    <section class="slide creamPP fullscreen " >
        <div class="grid-container-slidepoint">
            <div class="SlidePointImage">
                <img  src="pictures/iconsFr2/no-sick-people.png" />
            </div>
            <div class="SlidePointText smallerfont3">
                <ol class="nonumbers">
                    <li class="next bold">Zaleta : Oddziela model odczytu i zapisu </li>
                    <ol class="nonumbers">
                        <li class="next">Każda operacja zmieniajaca coś jest zdarzeniem. 
                         </li>
                            <li class="next">   Te zdarzenie trafia do kolejki</li>
                            
                        <li class="next">Kolejka może być obsłużona przez wiele endpointów i baz danych</li>
                        <li class="next">Kto powiedział, że możesz mieć jedną bazę do odczytu</li>
                </ol>
            </div>
          </div>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/gdzie/eventrepository.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Co zmienia <span class="blue2">Event Sourcing</span> w naszym systemie ?
        </span></span>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/Adobe/workflow-normal.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/Adobe/workflow.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/Adobe/workflow-02.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/Adobe/workflow-03.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:#8E8E8E">
        <figure>
            <img class="cover" src="pictures2/Adobe/workflow-04.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>Domain.Events
            👨‍💻
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DomainEvent</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 21px !important;">

                        public abstract class DomainEvent 
                        {
                            public AggregateKey Key { get; set; }
                        
                            public int Version { get; set; }
                            public DateTimeOffset TimeStamp { get; set; }
                        
                            protected DomainEvent(DateTimeOffset occuredOn, int version)
                            {
                                TimeStamp = occuredOn;
                                Version = version;
                            }
                        
                            protected DomainEvent(int version)
                            {
                                TimeStamp = AppTime.Now();
                                Version = version;
                            }
                        
                            protected DomainEvent()
                            {
                        
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">AggregateKey</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 21px !important;">
                        public class AggregateKey
                        {
                            public string Id { get; set; }
                    
                            public static readonly AggregateKey Empty 
                            = new AggregateKey();
                    
                            public override string ToString()
                            {
                                return Id;
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/domainevent/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DevloperSubmitedEvent</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 23px !important;">
                        public class DevloperSubmitedEvent : DomainEvent
                        {
                            public DeveloperUniqueId UniqueId { get; set; }
                            public string Name { get; set; }
                    
                            public DevloperSubmitedEvent(DeveloperUniqueId uniqueId,
                                string name)
                            {
                                UniqueId = uniqueId;
                                Name = name;
                                Key = uniqueId.GetAggregateKey();
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperAcceptedEvent</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 23px !important;">
                        public class DeveloperAcceptedEvent : DomainEvent
                        {
                            public DeveloperUniqueId UniqueId { get; set; }
                            public string Name { get; set; }
                            public DeveloperStatus Status { get; set; }
                    
                    
                            public DeveloperAcceptedEvent(DeveloperUniqueId uniqueId,
                                string name, DeveloperStatus status, int version)
                            {
                                UniqueId = uniqueId;
                                Status = status;
                                Name = name;
                                Version = version;
                                Key = uniqueId.GetAggregateKey();
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DeveloperRejectedEvent</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 23px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 23px !important;">
                        public class DeveloperRejectedEvent : DomainEvent
                        {
                            public DeveloperUniqueId UniqueId { get; set; }
                            public string Name { get; set; }
                            public DeveloperStatus Status { get; set; }
                    
                            public DeveloperRejectedEvent(DeveloperUniqueId uniqueId,
                        string name, DeveloperStatus status, int version)
                            {
                                UniqueId = uniqueId;
                                Status = status;
                                Name = name;
                                Version = version;
                                Key = uniqueId.GetAggregateKey();
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>Application.EventSourcing
            👨‍💻
        </span></span>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/applicationeventSourcing/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Co to jest wzorzec projektowy <span class="giveorange">Aggregate</span> ?
            <br /><span>🗃️</span>
      </span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" ><span class="giveorange">Aggregate</span> : to kolekcja obiektów którą chcemy traktować jako jednostkę
            <br />
            <span>🗃️
           
        </span></span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" ><span class="giveorange">Aggregate</span> : to encja która trzyma inne encje , a w niej są obiekty wartościowe
            <br /><span>🗃️

        </span></span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Celem <span class="giveorange">aggregatu</span> jest trzymanie modelu domenowego do 1 typu
            <br /><span>🗃️

            </span>


        </span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" ><span class="giveorange">Aggregat</span> sam sobie też jest atomowy w swojej persystencji
            <br /><span>🗃️

            </span>
        </span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Jak widzisz mamy różne zdarzenia  per model domenowy
            <br /><span>🗃️

            </span>
        </span>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >W tym przypadku będziemy mieli listę zdarzeń per model domenowy .
            <br />To jest nasz agreggat
            <br /><span>🗃️

            </span>
        
        </span>
    </section>
    <section class="slide creamPP   compact ">
        <h2>Co klasa abstrakcyjna AggregateRoot powinna mieć</h2>
        <ol class="nonumbers">
            <li class="next">Możliwość wczytania histori Listy od moich zdarzeń na obiekcie domenowych</li>
            <li class="next">Dodanie zmian na podstawie nowego zdarzania</li>
            <li class="next">Zaznaczenie, że zmiany zdarzeniowe są zatwierdzone </li>
        </ol>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">AggregateRoot</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 22px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 22px !important;">














































                        public abstract class AggregateRoot
                        {
                            private readonly List&lt;DomainEvent&gt; _changes = new List&lt;DomainEvent&gt;();
                                            
                            public AggregateKey Key { get; protected set; }
                            public int Version { get; protected set; }
                                            
                            public override string ToString()
                            {
                                return Key.Id;
                            }
                                            
                            public IEnumerable&lt;DomainEvent&gt; GetUncommittedChanges()
                            {
                                lock (_changes)
                                {
                                    return _changes.ToArray();
                                }
                            }
                                            
                            public void MarkChangesAsCommitted()
                            {
                                lock (_changes)
                                {
                                    Version = Version + _changes.Count;
                                    _changes.Clear();
                                }
                            }
                                            
                            public void LoadFromHistory(IEnumerable&lt;DomainEvent&gt; history)
                            {
                                foreach (var e in history)
                                {
                                    if (e.Version != Version + 1)
                                        throw new EventsOutOfOrderException(e.Key);
                                    ApplyChange(e, false);
                                }
                                            
                                            
                            }
                                            
                            protected void ApplyChange(DomainEvent @event)
                            {
                                ApplyChange(@event, true);
                            }
                                            
                            private void ApplyChange(DomainEvent @event, bool isNew)
                            {
                                lock (_changes)
                                {
                                    this.AsDynamic().Apply(@event);
                                            
                                    if (isNew)
                                    {
                                        _changes.Add(@event);
                                    }
                                    else
                                    {
                                        Key = @event.Key;
                                        Version++;
                                    }
                                }
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Pora na implementacje <span class="giveorange">AggregateRoot</span></span>
    </section>

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DevloperAggregate</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">










                        









                        





























                        public class DevloperAggregate : AggregateRoot
                        {
                            public DeveloperUniqueId UniqueId { get; set; }
                            public string Name { get; set; }
                            public DeveloperStatus Status { get; set; }


                            public DevloperAggregate(Developer cc)
                            {
                                var c = new DevloperSubmitedEvent
                                    (cc.UniqueId, cc.Name);
                                this.Key = c.UniqueId.GetAggregateKey();
                                ApplyChange(c);
                            }
                                            
                            public void Rejected(Developer cc)
                            {
                                var c = new DeveloperRejectedEvent
                                    (cc.UniqueId, cc.Name, cc.Status, cc.Version);
                                this.Key = c.UniqueId.GetAggregateKey();
                                ApplyChange(c);
                            }
                                            
                                            
                                            
                            public void Accepted(Developer cc)
                            {
                                var c = new DeveloperAcceptedEvent
                                               (cc.UniqueId, cc.Name, cc.Status, cc.Version);
                                ApplyChange(c);
                            }
                                            
                            private void Apply(DevloperSubmitedEvent e)
                            {
                                Status = DeveloperStatus.New;
                                            
                                Name = e.Name;
                                UniqueId = e.UniqueId;
                                Version = e.Version++;
                                this.Key = e.UniqueId.GetAggregateKey();
                            }
                                            
                            private void Apply(DeveloperAcceptedEvent e)
                            {
                                            
                                Status = e.Status;
                                            
                                Name = e.Name;
                                UniqueId = e.UniqueId;
                                Version = e.Version++;
                                this.Key = e.UniqueId.GetAggregateKey();
                            }
                                            
                            private void Apply(DeveloperRejectedEvent e)
                            {
                                Status = e.Status;
                                            
                                Name = e.Name;
                                UniqueId = e.UniqueId;
                                Version = e.Version++;
                                this.Key = e.UniqueId.GetAggregateKey();
                            }
                                            
                                            
                                            
                                            
                                            

                                            
                            public DevloperAggregate()
                            {
                                            
                            }
                                            
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Teraz piszemy <span>Kontrakty czyli interfejsy dla EventSourcing 👨‍💻
        </span></span>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/applicationeventSourcing/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">ISessionForEventSourcing</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 29px !important;">
                        public interface ISessionForEventSourcing
                        {
                            ExecutionStatus Add&lt;T&gt;(T aggregate) 
                            where T : AggregateRoot;

                            ExecutionStatus&lt;T&gt; Get&lt;T&gt;
                            (AggregateKey id, int? expectedVersion = null) 
                            where T : AggregateRoot;

                            ExecutionStatus Commit();
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/ADOBE/Session.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">IEventRepository</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 29px !important;">
                        public interface IEventRepository
                        {
                            void Save&lt;T&gt;
                            (T aggregate, int? expectedVersion = null) 
                            where T : AggregateRoot;

                            T Get&lt;T&gt;
                            (AggregateKey aggregateId) 
                            where T : AggregateRoot;
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/ADOBE/Session2.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/ADOBE/Session3.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">IEventStore</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 29px !important;">
                        public interface IEventStore
                        {
                            void Save(DomainEvent @event);

                            List&lt;DomainEvent&gt; Get
                            (AggregateKey aggregateId, int fromVersion);
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">IEventPublisher</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 29px !important;">
                        public interface IEventPublisher
                        {
                            void Publish&lt;T&gt;(T @event) where T : DomainEvent;
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>implementacyjny
            👨‍💻
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures/nuget/RabbitMQ.Client.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/eventsourcing/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SessionForEventSourcing</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">



















                        


















                        

                        




































                        public class SessionForEventSourcing : ISessionForEventSourcing
                        {
                            private readonly IEventRepository _repository;
                            private readonly Dictionary&lt;AggregateKey, AggregateDescriptor&gt; _trackedAggregates;
                    
                            public SessionForEventSourcing(IEventRepository repository)
                            {
                                if (repository == null)
                                    throw new ArgumentNullException(&quot;repository&quot;);
                    
                                _repository = repository;
                                _trackedAggregates = new Dictionary&lt;AggregateKey, AggregateDescriptor&gt;();
                            }
                    
                            public void Add&lt;T&gt;(T aggregate) where T : AggregateRoot
                            {
                                try
                                {
                                    if (!IsTracked(aggregate.Key))
                                        _trackedAggregates.Add(aggregate.Key,
                                            new AggregateDescriptor
                                            {
                                                Aggregate = aggregate,
                                                Version = aggregate.Version
                                            });
                                    else if (_trackedAggregates[aggregate.Key].Aggregate != aggregate)
                                        throw new ConcurrencyException(aggregate.Key);
                                }
                                catch (Exception ex)
                                {
                                    throw;
                                }
                            }
                    
                            public T Get&lt;T&gt;(AggregateKey id, int? expectedVersion = null) where T : AggregateRoot
                            {
                                try
                                {
                                    //w pamięci śledzącej sprawdzamy czy nie pr&#243;bujemy ze złą wersją dodać zdarzenie
                                    //oraz jeśli mamy zdarzenie w pamięci śledzącej to je zwracamy
                                    if (IsTracked(id))
                                    {
                                        var trackedAggregate = (T)_trackedAggregates[id].Aggregate;
                                        if (expectedVersion != null &amp;&amp; trackedAggregate.Version != expectedVersion)
                                            throw new ConcurrencyException(trackedAggregate.Key);
                                        return trackedAggregate;
                                    }
                    
                                    //jeśli nie mamy w pamieci to odpytujemy repozytorium
                                    var aggregate = _repository.Get&lt;T&gt;(id);
                                    if (expectedVersion != null &amp;&amp; aggregate.Version != expectedVersion)
                                        throw new ConcurrencyException(id);

                                    Add(aggregate); 
                                    //Dodajemy do pamięci śledzącej
                    
                                    return aggregate;
                                }
                                catch (Exception ex)
                                {
                                    throw;
                                }
                    
                    
                            }
                    
                            private bool IsTracked(AggregateKey id)
                            {
                                return _trackedAggregates.ContainsKey(id);
                            }
                    
                            public void Commit()
                            {
                                try
                                {
                                    foreach (var descriptor in _trackedAggregates.Values)
                                    {
                                        _repository.Save(descriptor.Aggregate, descriptor.Version);
                                    }
                                    _trackedAggregates.Clear();
                                }
                                catch (Exception ex)
                                {
                    
                                    throw;
                    
                                }
                    
                            }
                    
                            private class AggregateDescriptor
                            {
                                public AggregateRoot Aggregate { get; set; }
                                public int Version { get; set; }
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/ADOBE/Session3.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">EventRepository</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">

































                        public class EventRepository : IEventRepository
                        {
                            private readonly IEventStore _eventStore;
                            private readonly IEventPublisher _publisher;
                        
                            public EventRepository(IEventStore eventStore, IEventPublisher publisher)
                            {
                                if (eventStore == null)
                                    throw new ArgumentNullException(&quot;eventStore&quot;);
                                if (publisher == null)
                                    throw new ArgumentNullException(&quot;publisher&quot;);
                                _eventStore = eventStore;
                                _publisher = publisher;
                            }
                        
                            public void Save&lt;T&gt;(T aggregate, int? expectedVersion = null) where T : AggregateRoot
                            {
                                if (expectedVersion != null &amp;&amp; _eventStore.Get(
                                        aggregate.Key, expectedVersion.Value).Any())
                                    throw new ConcurrencyException(aggregate.Key);
                                var i = 0;
                                foreach (var @event in aggregate.GetUncommittedChanges())
                                {
                                    if (@event.Key == AggregateKey.Empty)
                                        @event.Key = aggregate.Key;
                                    if (@event.Key == AggregateKey.Empty)
                                        throw new AggregateOrEventMissingIdException(
                                            aggregate.GetType(), @event.GetType());
                                    i++;

                                    //Zwiększanie wersji o 1 i dodanie daty
                                    @event.Version = aggregate.Version + i;
                                    @event.TimeStamp = DateTimeOffset.UtcNow;

                                    //Zapisz do bazy zdarzeń i wyślij do kolejki
                                    _eventStore.Save(@event);
                                    _publisher.Publish(@event);
                                }
                                aggregate.MarkChangesAsCommitted();
                            }
                        
                            public T Get&lt;T&gt;(AggregateKey aggregateId) where T : AggregateRoot
                            {
                                return LoadAggregate&lt;T&gt;(aggregateId);
                            }
                        
                            private T LoadAggregate&lt;T&gt;(AggregateKey id) where T : AggregateRoot
                            {
                                var aggregate = AggregateFactory.CreateAggregate&lt;T&gt;();
                        
                                
                                var events = _eventStore.Get(id, -1);
                                if (!events.Any())
                                    throw new AggregateNotFoundException(id);
                        
                                aggregate.LoadFromHistory(events);
                                return aggregate;
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Teraz pokaż mi implementacje <span class="giveorange">IEventPublisher</span>
        </span></span>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/ADOBE/Session4.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Constants</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 21px !important;">
                        public class Constants
                        {
                            public const string QUEUE_DEVELOPER_SUBMITED = &quot;developers_submited&quot;;
                            public const string QUEUE_DEVELOPER_REJECTCED = &quot;developers_rejected&quot;;
                            public const string QUEUE_DEVELOPER_ACCEPTED = &quot;developers_accepted&quot;;
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">DomainEventHelper</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public static class DomainEventHelper
                        {
                            public static string WhatRabbitMQQueue(this DomainEvent @event)
                            {
                                string g = @event switch
                                {
                                    DevloperSubmitedEvent =&gt; Constants.QUEUE_DEVELOPER_SUBMITED,
                                    DeveloperAcceptedEvent =&gt; Constants.QUEUE_DEVELOPER_ACCEPTED,
                                    DeveloperRejectedEvent =&gt; Constants.QUEUE_DEVELOPER_REJECTCED,
                                    _ =&gt; throw new NotImplementedException(),
                                };
                                            
                                return g;
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">LiteSmallEventPublisher</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 18px !important;">



























                        public class LiteSmallEventPublisher : IEventPublisher
                        {
                            private readonly ConnectionFactory connectionFactory;
                                           
                            public LiteSmallEventPublisher(IHostingEnvironment env)
                            {
                                connectionFactory = new ConnectionFactory();
                                           
                                var builder = new Microsoft.Extensions.Configuration.ConfigurationBuilder()
                                .SetBasePath(env.ContentRootPath)
                                .AddJsonFile(&quot;appsettings.json&quot;, optional: false, reloadOnChange: false)
                                .AddEnvironmentVariables();
                                           
                                builder.Build().GetSection(&quot;RabbitMqSetting&quot;).Bind(connectionFactory);
                            }
                                           
                                           
                                           
                            public void Publish&lt;T&gt;(T @event) where T : DomainEvent
                            {
                                using (IConnection conn = connectionFactory.CreateConnection())
                                {
                                    using (IModel channel = conn.CreateModel())
                                    {
                                        var queue = @event.WhatRabbitMQQueue();
                                           
                                        channel.QueueDeclare(
                                            queue: queue,
                                            durable: false,
                                            exclusive: false,
                                            autoDelete: false,
                                            arguments: null
                                           
                                        );
                                           
                                        var body = Encoding.UTF8.GetBytes(JsonConvert.SerializeObject(@event));
                                           
                                        channel.BasicPublish(
                                            exchange: &quot;&quot;,
                                            routingKey: queue,
                                            basicProperties: null,
                                            body: body
                                        );
                                    }
                                }
                            }
                                           
                                           
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide creamPP">
        <span class="shout colors" ><span>Teraz pokaż mi implementacje <span class="giveorange">IEventStore</span>
        </span></span>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures/ADOBE/Session5.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide conicG2">
        <span class="shout colors" >Jak wygląda zapisywanie zdarzeń do <br /> <span>bazy w pamięci RAM
            
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">InMemoryEventStore</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 18px !important;">






                        public class InMemoryEventStore : IEventStore
                        {

                            //OTO nasz EventStore jako Dictionary :)
                            private readonly Dictionary&lt;AggregateKey, List&lt;DomainEvent&gt;&gt; 
                            customerInMemDictionary = 
                            new Dictionary&lt;AggregateKey, List&lt;DomainEvent&gt;&gt;();


                            public List&lt;DomainEvent&gt; Get(AggregateKey aggregateId, int fromVersion)
                            {
                                List&lt;DomainEvent&gt; geekLemonEvents;
                                customerInMemDictionary.TryGetValue(aggregateId, out geekLemonEvents);
                                if (geekLemonEvents != null)
                                {
                                    return geekLemonEvents.Where(x =&gt; x.Version &gt; fromVersion).ToList();
                                }

                                return new List&lt;DomainEvent&gt;();
                            }

                            public void Save(DomainEvent @event)
                            {
                                List&lt;DomainEvent&gt; geekLemonEvents;
                                customerInMemDictionary.TryGetValue(@event.Key, out geekLemonEvents);
                                if (geekLemonEvents == null)
                                {
                                    geekLemonEvents = new List&lt;DomainEvent&gt;();
                                    customerInMemDictionary.Add(@event.Key, geekLemonEvents);
                                }
                                geekLemonEvents.Add(@event);
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>EventStorePlugin.SQLite
            👨‍💻
        </span></span>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/plugin/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/plugin/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">EvetStore w SQllite</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 29px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 29px !important;">
                        BEGIN TRANSACTION;
                        CREATE TABLE IF NOT EXISTS &quot;EventStore&quot; (
                            &quot;Id&quot;    INTEGER NOT NULL UNIQUE,
                            &quot;Key&quot;    TEXT NOT NULL,
                            &quot;AssemblyQualifiedName&quot;    TEXT NOT NULL,
                            &quot;Value&quot;    TEXT NOT NULL,
                            &quot;Version&quot;    INTEGER,
                            PRIMARY KEY(&quot;Id&quot; AUTOINCREMENT)
                        );
                        COMMIT;
                        
                    </code>
                </pre>
            </div>
        </div>
    </section>   

    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SqlLiteEventStore</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 18px !important;">






















































                        public class SqlLiteEventStore : IEventStore
                        {
                            private IEventStoreSQLiteContext _geekLemonContext;
                                            
                            public SqlLiteEventStore(IEventStoreSQLiteContext context)
                            {
                                _geekLemonContext = context;
                            }
                                            
                            public List&lt;DomainEvent&gt; Get(AggregateKey aggregateId, int fromVersion)
                            {
                                using var connection = new SqliteConnection
                                    (_geekLemonContext.ConnectionString);
                                            
                                try
                                {
                                    var r = connection.Query&lt;EventTemp&gt;
                                    (@&quot;SELECT Id,Key, Value, AssemblyQualifiedName, Version FROM EventSTORE
                                        WHERE Key = @aggregateId and Version &gt; @Version;&quot;, new
                                    {
                                        @aggregateId = aggregateId.Id,
                                        @Version = fromVersion
                                    });
                                            
                                    List&lt;DomainEvent&gt; de = new List&lt;DomainEvent&gt;();
                                            
                                    foreach (var item in r)
                                    {
                                        Assembly asm = typeof(DomainEvent).Assembly;
                                        Type type = TypeRecon.ReconstructType(item.AssemblyQualifiedName, true, asm);
                                            
                                        var domain = JsonConvert.
                                            DeserializeObject(item.Value, type);
                                            
                                        de.Add(domain as DomainEvent);
                                    }
                                            
                                    return de;
                                }
                                catch (Exception ex)
                                {
                                    throw;
                                }
                            }
                                            
                            public void Save(DomainEvent @event)
                            {
                                using var connection = new SqliteConnection
                                    (_geekLemonContext.ConnectionString);
                                            
                                            
                                try
                                {
                                    var q = @&quot;INSERT INTO EventSTORE(Key, Value,
                                        AssemblyQualifiedName
                                        ,Version)
                                        VALUES (@Key, @Value, @AssemblyQualifiedName,@Version);&quot;;
                                            
                                            
                                    var result = connection.Execute(q, new
                                    {
                                        @Key = @event.Key.Id,
                                        @Value = JsonConvert.SerializeObject(@event),
                                        @AssemblyQualifiedName = @event.GetType().AssemblyQualifiedName,
                                        @Version = @event.Version,
                                    }
                                    );
                                            
                                }
                                catch (Exception ex)
                                {
                                    throw;
                                }
                            }
                                            
                                            
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Instalator</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 18px !important;">
                        public static IServiceCollection
                        AddEventStoreSqlLite
                        (this IServiceCollection services,
                        IConfiguration configuration)
                        {
                            var connection = configuration.
                                GetConnectionString(&quot;EventStoreSQLiteConnectionString&quot;);
                                    
                            services.AddScoped&lt;IEventStoreSQLiteContext, EventStoreSQLiteContext&gt;
                                (
                                    (services) =&gt;
                                    {
                                        var c =
                                        new EventStoreSQLiteContext(connection);
                                        return c;
                                    }
                                );
                                    
                            services.AddScoped&lt;IEventStore, SqlLiteEventStore&gt;();
                                    
                            return services;
                        }

                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Wracamy do projektu API<br /><span>👨‍💻
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">ConfigureServices</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 21px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 21px !important;">
                        public void ConfigureServices(IServiceCollection services)
                        {
                            ....
                            services.AddLiteSmallConferenceCQRS(Configuration);
                            services.AddPersitenceDapperSQLite(Configuration);
                
                            services.AddEventStoreSqlLite(Configuration);
                            services.AddEventSourcing(Configuration);
                
                            services.AddControllers();
                            services.AddCors(options =>
                            {
                                options.AddPolicy("Open",
                                    builder => builder.AllowAnyOrigin().AllowAnyHeader().AllowAnyMethod());
                            });
                        }

                    </code>
                </pre>
            </div>
        </div>
    </section>    
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/api/06.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">ZEsDeveloperController</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 18px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 18px !important;">















                        













                        






                        






















                        































































                        [Route(&quot;api/[controller]&quot;)]
                        [ApiController]
                        public class ZEsDeveloperController : BaseLiteSmallConference
                        {
                            private readonly IMediator _mediator;
                                            
                            public ZEsDeveloperController(IMediator mediator)
                            {
                                _mediator = mediator;
                            }
                                            
                            [HttpPost(&quot;submit&quot;, Name = &quot;submitdeveloperEs&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;DeveloperIds&gt;&gt; Submit([FromBody] EsSubmitDeveloperCommand request)
                            {
                                var result = await _mediator.Send(request);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return Ok(result.DeveloperIds);
                            }
                                            
                            [HttpGet(&quot;all/{filter}&quot;, Name = &quot;getalldevelopersES&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;DeveloperInListViewModel&gt;&gt; GetAllDevelopers(int filter)
                            {
                                GetAllDevelopersQuery getAllDevelopersQuery = new GetAllDevelopersQuery()
                                {
                                    Filter = (FilterDeveloperStatus)filter,
                                    queryWitchDataBase = QueryWitchDataBase.WithEventSourcing
                                };
                                            
                                var result = await _mediator.Send(getAllDevelopersQuery);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                return Ok(result.List);
                            }
                                            
                                            
                                            
                            [HttpGet(&quot;uniqueid/{uid}&quot;, Name = &quot;GetDeveloperByUniqueIdEs&quot;)]
                            [ProducesResponseType(StatusCodes.Status200OK)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesDefaultResponseType]
                            public async Task&lt;ActionResult&lt;DeveloperViewModel&gt;&gt; GetDeveloperByUniqueId(Guid uid)
                            {
                                var result = await _mediator.Send(
                                    (new GetDeveloperQuery()
                                    {
                                        DeveloperUniqueId = new DeveloperUniqueId(uid),
                                        queryWitchDataBase = QueryWitchDataBase.WithEventSourcing
                                    }));
                                            
                                return Ok(result.Developer);
                            }
                                            
                            [HttpPost(&quot;reject&quot;, Name = &quot;rejectdevelopers&quot;)]
                            [ProducesResponseType(StatusCodes.Status204NoContent)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;int&gt;&gt; Reject([FromBody] EsRejectDeveloperCommand rejectdeveloperCommand)
                            {
                                var result = await _mediator.Send(rejectCallForSpeechCommand);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                            
                                return NoContent();
                                            
                            }
                                            
                                            
                            [HttpPost(&quot;accept&quot;, Name = &quot;acceptcallforspeech&quot;)]
                            [ProducesResponseType(StatusCodes.Status204NoContent)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            [ProducesResponseType(StatusCodes.Status400BadRequest)]
                            [ProducesResponseType(StatusCodes.Status403Forbidden)]
                            [ProducesResponseType(420)]
                            [ProducesResponseType(StatusCodes.Status404NotFound)]
                            public async Task&lt;ActionResult&lt;int&gt;&gt; Accept([FromBody] EsAcceptDeveloperCommand acceptDeveloperCommand)
                            {
                                var result = await _mediator.Send(acceptDeveloperCommand);
                                            
                                if (result.Status == ResponseStatus.BussinesLogicError)
                                    return Forbid();
                                if (result.Status == ResponseStatus.NotFoundInDataBase)
                                    return NotFound();
                                if (result.Status == ResponseStatus.ValidationError)
                                    return BadRequest();
                                if (result.Status == ResponseStatus.BadQuery)
                                    return BadRequest();
                                if (!result.Success)
                                    return MethodFailure(result.Message);
                                            
                                            
                                return NoContent();
                                            
                            }
                        }

                    </code>
                </pre>
            </div>
        </div>
    </section>
    <section class="slide visgrey" >
        <figure>
            <img class="cover" src="pictures2/cqrswithevent/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">EsAcceptDeveloperCommand</h2>
            </div>
            <div class="PlaceCodeHere">
                <pre style="font-size: 28px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 28px !important;">
                        public class EsAcceptDeveloperCommand
                        : IRequest&lt;EsAcceptDeveloperCommandResponse&gt;
                        {
                            public Guid DeveloperUniqueId { get; set; }
                            public int Version { get; set; }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">EsAcceptDeveloperCommandHandler</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">


























                        public class EsAcceptDeveloperCommandHandler
                        :
                        IRequestHandler&lt;EsAcceptDeveloperCommand, EsAcceptDeveloperCommandResponse&gt;
                        {
                            private readonly ISessionForEventSourcing _sessionForEventSourcing;
                            private readonly IMapper _mapper;
                                        
                            public EsAcceptDeveloperCommandHandler(
                                ISessionForEventSourcing sessionForEventSourcing, IMapper mapper)
                            {
                                _mapper = mapper;
                                _sessionForEventSourcing = sessionForEventSourcing;
                            }
                                        
                            public Task&lt;EsAcceptDeveloperCommandResponse&gt;
                                Handle(EsAcceptDeveloperCommand request, 
                                CancellationToken cancellationToken)
                            {
                                var developerUniqueId = _mapper.Map&lt;DeveloperUniqueId&gt;
                                    (request.DeveloperUniqueId);
                                        
                                var aggregateDevloper = _sessionForEventSourcing.Get&lt;DevloperAggregate&gt;
                                    (developerUniqueId.GetAggregateKey(), null);
                                        
                                if (aggregateDevloper.Version &gt; request.Version)
                                    return Task.FromResult(new EsAcceptDeveloperCommandResponse
                                        ($@&quot;You sended old version.
                                        Yours {request.Version}.
                                        In Event database :{aggregateDevloper.Version}&quot;, false));
                                        
                                if (aggregateDevloper.Status != DeveloperStatus.New)
                                    return Task.FromResult(new EsAcceptDeveloperCommandResponse
                                        ($@&quot;Devloper status in eventhistory is {aggregateDevloper.Status}.
                                            Can&#39;t be Accepted&quot;, false));
                                        
                                var developer = _mapper.Map&lt;Developer&gt;(aggregateDevloper);
                                developer.Status = DeveloperStatus.Accepted;
                                        
                                aggregateDevloper.Accepted(developer);
                                _sessionForEventSourcing.Commit();
                                        
                                return Task.FromResult(new EsAcceptDeveloperCommandResponse());
                                        
                            }
                                        
                                        
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">EsAcceptDeveloperCommandHandler</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        


















                        public class EsRejectDeveloperCommandHandler
                        :
                        IRequestHandler&lt;EsRejectDeveloperCommand, EsRejectDeveloperCommandResponse&gt;
                        {
                                
                            private readonly ISessionForEventSourcing _sessionForEventSourcing;
                            private readonly IMapper _mapper;
                                    
                            public EsRejectDeveloperCommandHandler(
                                ISessionForEventSourcing sessionForEventSourcing, IMapper mapper)
                            {
                                _mapper = mapper;
                                _sessionForEventSourcing = sessionForEventSourcing;
                            }
                                    
                            public Task&lt;EsRejectDeveloperCommandResponse&gt; Handle(EsRejectDeveloperCommand request,
                                CancellationToken cancellationToken)
                            {
                                var developerUniqueId = _mapper.Map&lt;DeveloperUniqueId&gt;
                                    (request.DeveloperUniqueId);
                                    
                                var aggregateDevloper = _sessionForEventSourcing.Get&lt;DevloperAggregate&gt;
                                    (developerUniqueId.GetAggregateKey(), null);
                                    
                                if (aggregateDevloper.Version &gt; request.Version)
                                    return Task.FromResult(new EsRejectDeveloperCommandResponse
                                        ($&quot;You sended old version.
                                        Yours {request.Version}.
                                        In Event database :{aggregateDevloper.Version}&quot;, false));
                                    
                                if (aggregateDevloper.Status != DeveloperStatus.New)
                                    return Task.FromResult(new EsRejectDeveloperCommandResponse
                                        ($&quot;Devloper status in eventhistory is {aggregateDevloper.Status}.
                                        Can&#39;t be Rejected&quot;, false));
                                    
                                var developer = _mapper.Map&lt;Developer&gt;(aggregateDevloper);
                                developer.Status = DeveloperStatus.Rejected;
                                    
                                aggregateDevloper.Rejected(developer);
                                _sessionForEventSourcing.Commit();
                                    
                                return Task.FromResult(new EsRejectDeveloperCommandResponse());
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">EsAcceptDeveloperCommandHandler</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                              















                        public class EsSubmitDeveloperCommandHandler
                        :
                        IRequestHandler&lt;EsSubmitDeveloperCommand, EsSubmitDeveloperCommandResponse&gt;
                        {
                                              
                              private readonly ISessionForEventSourcing _sessionForEventSourcing;
                              private readonly IMapper _mapper;
                                              
                              public EsSubmitDeveloperCommandHandler(
                                  ISessionForEventSourcing sessionForEventSourcing, IMapper mapper)
                              {
                                  _mapper = mapper;
                                  _sessionForEventSourcing = sessionForEventSourcing;
                              }
                                              
                              public async Task&lt;EsSubmitDeveloperCommandResponse&gt; Handle
                                  (EsSubmitDeveloperCommand request, CancellationToken cancellationToken)
                              {
                                  var validator = new EsSubmitDeveloperCommandValidator();
                                  var validatorResult = await validator.ValidateAsync(request);
                                              
                                  if (!validatorResult.IsValid)
                                      return new EsSubmitDeveloperCommandResponse(validatorResult);
                                              
                                  var developer = _mapper.Map&lt;Developer&gt;(request);
                                              
                                  var developerAgreggate = new DevloperAggregate(developer);
                                              
                                  _sessionForEventSourcing.Add&lt;DevloperAggregate&gt;(developerAgreggate);
                                  _sessionForEventSourcing.Commit();
                                              
                                  var ids = _mapper.Map&lt;DeveloperIds&gt;(developer.Ids());
                                              
                                  return new EsSubmitDeveloperCommandResponse(ids);
                              }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 


    <section class="slide creamG">
        <span class="shout colors" ><span>Jak to wszystko działa ?
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/api/SwaggerUIWithEVENTSourcing.gif" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/final.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/final-01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:white">
        <figure>
            <img class="cover" src="pictures2/final-02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide conicG">
        <span class="shout colors" ><span>Chcę więcej...
        </span></span>
    </section>
    <section class="slide conicG">
        <span class="shout colors" ><span>Zobacz wszystkie slajdy i kod na moim blogu
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/chcewiecej.gif" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide conicG">
        <span class="shout colors" >Piszemy więc projekt<br /> <span>BackgroundEventHandlerServer
            👨‍💻
        </span></span>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/gdzie/eventHandlers.png" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/background/01.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Constants</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public class Constants
                        {
                            public const string QUEUE_DEVELOPER_SUBMITED = "developers_submited";
                            public const string QUEUE_DEVELOPER_REJECTCED = "developers_rejected";
                            public const string QUEUE_DEVELOPER_ACCEPTED = "developers_accepted";
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">Constants</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public interface ISettings
                        {
                            TimeSpan Frequency { get; set; }
                            TimeSpan Timeout { get; set; }
                        }
                    
                        public class Settings : ISettings
                        {
                            public TimeSpan Frequency { get; set; }
                            public TimeSpan Timeout { get; set; }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/background/02.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide" style="background-color:black">
        <figure>
            <img class="cover" src="pictures2/background/03.PNG" alt="blog">
            <figcaption class="white">Copyright © 2021 Diagram</figcaption>
        </figure>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">ISubscribeBase</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public interface ISubscribeBase
                        {
                            string QUEUE_Name { get; }
                            DomainEvent DeserializeObject(string json);
                                          
                            Task HandleBasicDeliver(string consumerTag,
                                ulong deliveryTag, bool redelivered, string exchange,
                                string routingKey,
                                IBasicProperties properties, ReadOnlyMemory&lt;byte&gt; body);
                                          
                            void StartSubing(IModel channel);
                                          
                            void Dispose();
                                          
                            Task&lt;ExecutionStatus&gt; HandleEvent(DomainEvent @event);
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubscribeBase</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        



















                        









                        
                        public abstract class SubscribeBase : ISubscribeBase
                        {
                            private MessageReceiverBase Consumer { get; set; }
                            private IModel _channel;
                                            
                            public abstract string QUEUE_Name { get; }
                                            
                            public SubscribeBase()
                            {
                                            
                                            
                            }
                                            
                            public void StartSubing(IModel channel)
                            {
                                _channel = channel;
                                Consumer = new MessageReceiverBase(channel, this);
                                channel.BasicConsume(this.QUEUE_Name,
                                                   false, Consumer);
                            }
                                            
                            public abstract DomainEvent DeserializeObject(string json);
                                            
                                            
                            public async Task HandleBasicDeliver(string consumerTag, ulong deliveryTag,
                                bool redelivered, string exchange, string routingKey, IBasicProperties
                                properties, ReadOnlyMemory&lt;byte&gt; body)
                            {
                                var json = Encoding.UTF8.GetString(body.Span);
                                var obj = DeserializeObject(json);
                                var status = await HandleEvent(obj);
                                            
                                if (status.Success)
                                {
                                    try
                                    {
                                        _channel.BasicAck(deliveryTag, false);
                                    }
                                    catch (Exception ex)
                                    {
                                            
                                        throw;
                                    }
                                }
                                            
                            }
                                            
                            public void Dispose()
                            {
                                Consumer.Dispose();
                            }
                                            
                            public abstract Task&lt;ExecutionStatus&gt; HandleEvent(DomainEvent @event);
                                            
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide creamPP">
        <span class="shout colors" ><span>Zobaczmy jak wygląda <span class="giveorange">MessageReceiverBase</span> 
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">MessageReceiverBase</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        



















                        public class MessageReceiverBase : DefaultBasicConsumer
                        {
                            private readonly IModel _channel;
                                            
                            private ISubscribeBase _messageReceiverBasez;
                                            
                            public void Dispose()
                            {
                                _channel.Dispose();
                            }
                                            
                                            
                            public MessageReceiverBase(IModel channel, ISubscribeBase messageReceiverBasez)
                            {
                                _messageReceiverBasez = messageReceiverBasez;
                                _channel = channel;
                            }
                                            
                            public override void HandleBasicDeliver(string consumerTag,
                                ulong deliveryTag, bool redelivered, string exchange,
                                string routingKey,
                                IBasicProperties properties, ReadOnlyMemory&lt;byte&gt; body)
                            {
                                            
                                Console.ForegroundColor = ConsoleColor.DarkGreen;
                                Console.WriteLine($&quot;Consuming Message&quot;);
                                Console.WriteLine(string.Concat(&quot;Message received from the exchange &quot;, exchange));
                                Console.WriteLine(string.Concat(&quot;Consumer tag: &quot;, consumerTag));
                                Console.WriteLine(string.Concat(&quot;Delivery tag: &quot;, deliveryTag));
                                Console.WriteLine(string.Concat(&quot;Routing tag: &quot;, routingKey));
                                            
                                var json = Encoding.UTF8.GetString(body.Span);
                                Console.WriteLine(string.Concat(&quot;Message: &quot;, json));
                                Console.ForegroundColor = ConsoleColor.Gray;
                                _messageReceiverBasez.HandleBasicDeliver
                                    (consumerTag, deliveryTag, redelivered, exchange, routingKey, properties, body);
                                            
                                            
                                            
                                            
                                            
                            }

                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide creamPP">
        <span class="shout colors" ><span>Zobaczmy jak wygląda <span class="giveorange">SubscribeSubmitDeveloper</span> 
        i <span class="giveorange">SubscribeAcceptDeveloper</span>  i <span class="giveorange">SubscribeRejectDeveloper</span> 
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubscribeSubmitDeveloper</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">











                        public class SubscribeSubmitDeveloper : SubscribeBase
                        {

                            private IZEsDeveloperRepository _ZEsDeveloperRepository;
                            private IMapper _mapper;
                                            
                            public SubscribeSubmitDeveloper(IZEsDeveloperRepository zEsDeveloperRepository,
                                IMapper mapper) :
                                base()
                            {
                                _ZEsDeveloperRepository = zEsDeveloperRepository;
                                _mapper = mapper;
                            }
                                            
                                            
                            public override string QUEUE_Name =&gt; Constants.QUEUE_DEVELOPER_SUBMITED;
                                            
                            public override DomainEvent DeserializeObject(string json)
                            {
                                return JsonConvert.DeserializeObject&lt;DevloperSubmitedEvent&gt;(json);
                            }
                                            
                            public override async Task&lt;ExecutionStatus&gt; HandleEvent(DomainEvent @event)
                            {
                                DevloperSubmitedEvent developerSubmitEvent = @event as DevloperSubmitedEvent;
                                            
                                var cfs = _mapper.Map&lt;Developer&gt;(developerSubmitEvent);
                                            
                                var execution = await
                                    _ZEsDeveloperRepository.SubmitAsync(cfs);
                                            
                                if (execution == null)
                                    return new ExecutionStatus() { Success = false };
                                            
                                return new ExecutionStatus() { Success = true };
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubscribeAcceptDeveloper</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">







                        public class SubscribeAcceptDeveloper : SubscribeBase
                        {
                                            
                            private IZEsDeveloperRepository _ZEsDeveloperRepository;
                            private IMapper _mapper;
                                            
                            public SubscribeAcceptDeveloper(IZEsDeveloperRepository zEsDeveloperRepository,
                                IMapper mapper) :
                                base()
                            {
                                _ZEsDeveloperRepository = zEsDeveloperRepository;
                                _mapper = mapper;
                            }
                                            
                            public override string QUEUE_Name =&gt; Constants.QUEUE_DEVELOPER_ACCEPTED;
                                            
                            public override DomainEvent DeserializeObject(string json)
                            {
                                return JsonConvert.DeserializeObject&lt;DeveloperAcceptedEvent&gt;(json);
                            }
                                            
                            public override async Task&lt;ExecutionStatus&gt; HandleEvent(DomainEvent @event)
                            {
                                DeveloperAcceptedEvent developerEvent = @event as DeveloperAcceptedEvent;
                                            
                                var cfs = _mapper.Map&lt;Developer&gt;(developerEvent);
                                            
                                var status = await _ZEsDeveloperRepository.SaveAcceptenceAsync(cfs.UniqueId);
                                            
                                return new ExecutionStatus() { Success = status };
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">SubscribeRejectDeveloper</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">







                        public class SubscribeRejectDeveloper : SubscribeBase
                        {

                            private IZEsDeveloperRepository _ZEsDeveloperRepository;
                            private IMapper _mapper;
                                            
                            public SubscribeRejectDeveloper(IZEsDeveloperRepository zEsDeveloperRepository,
                                IMapper mapper) :
                                base()
                            {
                                _ZEsDeveloperRepository = zEsDeveloperRepository;
                                _mapper = mapper;
                            }
                                            
                            public override string QUEUE_Name =&gt; Constants.QUEUE_DEVELOPER_REJECTCED;
                                            
                            public override DomainEvent DeserializeObject(string json)
                            {
                                return JsonConvert.DeserializeObject&lt;DeveloperRejectedEvent&gt;(json);
                            }
                                            
                            public override async Task&lt;ExecutionStatus&gt; HandleEvent(DomainEvent @event)
                            {
                                DeveloperRejectedEvent developerEvent = @event as DeveloperRejectedEvent;
                                            
                                var cfs = _mapper.Map&lt;Developer&gt;(developerEvent);
                                            
                                var status = await _ZEsDeveloperRepository.SaveRejectionAsync(cfs.UniqueId);
                                            
                                return new ExecutionStatus() { Success = status };
                            }
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide creamPP">
        <span class="shout colors" ><span>Zobaczmy jak wygląda klasa <span class="giveorange">Startup</span> i wstrzykiwane zależności
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">ConfigureServices</h2>
            </div>
            <div class="PlaceCodeHere ">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">
                        public void ConfigureServices(IServiceCollection services)
                        {
                            services.AddAutoMapper(Assembly.GetExecutingAssembly());
                            services.AddPersitenceDapperSQLite(Configuration);
                                        
                            var seriFileLogger = new LoggerConfiguration().WriteTo.File(@&quot;D:\Temp\&quot;).CreateLogger();
                            services.AddSingleton&lt;Serilog.ILogger&gt;(seriFileLogger);
                                        
                            services.AddSingleton&lt;ISettings&gt;(new Settings()
                            {
                                Timeout = TimeSpan.FromSeconds(5),
                                Frequency = TimeSpan.FromSeconds(5),
                            });
                                        
                            //dont change the order
                            services.AddTransient&lt;ISubscribeBase, SubscribeSubmitDeveloper&gt;();
                            services.AddTransient&lt;ISubscribeBase, SubscribeAcceptDeveloper&gt;();
                            services.AddTransient&lt;ISubscribeBase, SubscribeRejectDeveloper&gt;();
                                        
                                        
                            services.AddTransient&lt;ISubscribeBase[]&gt;
                                (p =&gt; p.GetServices&lt;ISubscribeBase&gt;().ToArray());
                                        
                            services.AddHostedService&lt;BackgroundEventHandlersServerService&gt;();
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 
    <section class="slide creamPP">
        <span class="shout colors" ><span>A oto nasz serwis działający w tle <span class="giveorange">BackgroundEventHandlersServerService</span> i wstrzykiwane zależności
        </span></span>
    </section>
    <section class="slide prism over bhgry">
        <div class="grid-container">
            <div class="HeaderTitle PP PP"> 
                <h2 class="headerCODE PP PP">BackgroundEventHandlersServerService</h2>
            </div>
            <div class="PlaceCodeHere canscroll">
                <pre style="font-size: 19px;overflow: hidden;  " class="language-csharp">
                    <code style="line-height: 19px !important;">


























































































                        public class BackgroundEventHandlersServerService : BackgroundService
                        {
                            private readonly ILogger Logger;
                            private readonly ISettings Settings;
                                            
                            private readonly ISubscribeBase[] _subscribes;
                                            
                            private string _ContentRootPath;
                                            
                            public BackgroundEventHandlersServerService(ILogger logger, ISettings settings,
                                IHostingEnvironment env,
                                ISubscribeBase[] subscribes)
                            {
                                Settings = settings;
                                Logger = logger;
                                _subscribes = subscribes;
                                            
                                            
                                _ContentRootPath = env.ContentRootPath;
                            }
                                            
                                            
                            protected async override Task ExecuteAsync(CancellationToken stoppingToken)
                            {
                                ConnectionFactory connectionFactory = new ConnectionFactory();
                                var builder = new ConfigurationBuilder()
                                    .SetBasePath(_ContentRootPath)
                                    .AddJsonFile(&quot;appsettings.json&quot;, optional: false, reloadOnChange: false)
                                    .AddEnvironmentVariables();
                                            
                                builder.Build().GetSection(&quot;RabbitMqSetting&quot;).Bind(connectionFactory);
                                            
                                using IConnection conn = connectionFactory.CreateConnection();
                                using IModel channel = conn.CreateModel();
                                            
                                Console.WriteLine(&quot;CreateConnection CreateModel&quot;);
                                            
                                try
                                {
                                    Console.ForegroundColor = ConsoleColor.DarkCyan;
                                    foreach (var item in _subscribes)
                                    {
                                        channel.QueueDeclare(
                                            queue: item.QUEUE_Name,
                                            durable: false,
                                            exclusive: false,
                                            autoDelete: false,
                                            
                                            arguments: null
                                        );
                                            
                                        Console.WriteLine($&quot;QueueDeclare {item.QUEUE_Name}&quot;);
                                    }
                                            
                                    foreach (var item in _subscribes)
                                    {
                                        item.StartSubing(channel);
                                        Console.WriteLine($&quot;StartSubing {item.QUEUE_Name}&quot;);
                                    }
                                    Console.ForegroundColor = ConsoleColor.Gray;
                                }
                                catch (Exception ex)
                                {
                                    Console.ForegroundColor = ConsoleColor.Red;
                                    Console.WriteLine($&quot;Exception {ex}&quot;);
                                    Console.ForegroundColor = ConsoleColor.Gray;
                                    LogError(ex.Message);
                                }
                                            
                                int i = 0;
                                while (!stoppingToken.IsCancellationRequested)
                                {
                                    i++;
                                    Console.ForegroundColor = (ConsoleColor)i;
                                    Console.WriteLine($&quot;Still Working and Still Waiting&quot;);
                                    Console.ForegroundColor = ConsoleColor.Gray;
                                            
                                    if (i == 15)
                                    {
                                        Console.Clear();
                                        i = 0;
                                    }
                                            
                                            
                                    await Task.Delay(Settings.Frequency, stoppingToken);
                                }
                            }
                                            
                            public async override Task StopAsync(CancellationToken cancellationToken)
                            {
                                foreach (var item in _subscribes)
                                {
                                    try
                                    {
                                        item.Dispose();
                                    }
                                    catch (Exception)
                                    {
                                            
                                    }
                                            
                                }
                                            
                                await base.StopAsync(cancellationToken);
                            }
                                            
               
                            private void LogError(string error)
                            {
                                Logger.Error(error);
                            }
                                            
                        }
                    </code>
                </pre>
            </div>
        </div>
    </section> 


    <!-- <div class="progress"></div> -->
    <footer class="badge badge-top-left">
        <a href="#" class="fullscreen">Fullscreen</a>
    </footer>

    <script src="vendors/gamepad/gamepad.js"></script>
    <script src="vendors/shower/shower.min.js"></script>
    <script src="vendors/shower-gamepad/shower.gamepad.js"></script>

    <!-- Prism.js -->
    <script src="vendors/prism/prism.js"></script>
    <script src="vendors/prism/custom-prism.js"></script>

</body>

</html>